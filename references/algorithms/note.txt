Note: functions have yet to be tested